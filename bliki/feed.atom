<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
  <title>Kjell-Magne Øierud's Bliki</title>
  <subtitle>Thoughts on software development</subtitle>
  <link href="http://oierud.name/~kjellm/bliki/" rel="self" />
  <link href="http://oierud.name/~kjellm/" />
  <updated>2011-11-25T19:27:30+01:00</updated>
  <author>
    <name>Kjell-Magne Øierud</name>
    <email>NA</email>
  </author>
  <id>http://oierud.name/~kjellm/</id>
  
  <entry>
    <title>Achoo --- The Achievo CLI</title>
    <link href="/bliki/AchooTheAchievoCLI.html" />
    <id>tag:oierud.name/~kjellm,2010-02-18:1266524571</id>
    <updated>2010-02-18T21:22:51+01:00</updated>
    <content type="html">



&lt;p&gt;To ease the pain of hour registration, I have created a command
line shell for the hour registration system we use at Redpill Linpro
-- &lt;a href=&quot;http://achievo.org&quot;&gt;Achievo&lt;/a&gt;.

&lt;p&gt;The code is hosted on Github, and you can find the code together
with install instructions &lt;a
href=&quot;https://github.com/kjellm/achoo&quot;&gt;here&lt;/a&gt;.

&lt;p&gt;To illustrate it's capabilities, I'll walk you through an example
session.

&lt;h3&gt;Register hours&lt;/h3&gt;

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
$ &lt;em&gt;rlwrap achoo&lt;/em&gt;         # rlwrap adds some line editing goodness, but you can start it with just 'achoo' as well
Welcome to Achoo!
 1. Register hours
 2. Show flexitime balance
 3. Day hour report
 4. Week hour report
 5. Holiday balance
 6. Lock month
 0. Exit
&lt;strong&gt;[1]&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
&lt;strong&gt;Date ([today] | ?)&amp;gt;&lt;/strong&gt; &lt;em&gt;?&lt;/em&gt;
Accepted formats:
         today | (+|-)n | [[[YY]YY]-[M]M]-[D]D

    January 2010         February 2010           March 2010
Mo Tu We Th Fr Sa Su  Mo Tu We Th Fr Sa Su  Mo Tu We Th Fr Sa Su
             1  2  3   1  2  3  4  5  6  7   1  2  3  4  5  6  7
 4  5  6  7  8  9 10   8  9 10 11 12 13 14   8  9 10 11 12 13 14
11 12 13 14 15 16 17  15 16 17 &lt;span style=&quot;color:white; background-color:black;&quot;&gt;18&lt;/span&gt; 19 20 21  15 16 17 18 19 20 21
18 19 20 21 22 23 24  22 23 24 25 26 27 28  22 23 24 25 26 27 28
25 26 27 28 29 30 31                        29 30 31

&lt;strong&gt;Date ([today] | ?)&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
Recently used projects
 1. p1: NiceCustomer - Consulting
 2. p2: AnnoyingCustomer - Consulting
 3. abs: Absence
 4. var: Various
 0. Other
&lt;strong&gt;Project [1]&gt;&lt;/strong&gt; &lt;em&gt;2&lt;/em&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If the project you are looking for is not in the list with recently
used projects, select &lt;em&gt;0&lt;/em&gt; to get the complete list of your
projects.

&lt;p&gt;When there is only one phase assosiated with the selected project,
achoo will automatically select it and move on. For projects with more
than one phase, you get a menu:

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
Phases
 1. Cool phase
 2. Boring phase
&lt;strong&gt;Phase ID&amp;gt;&lt;/strong&gt; &lt;em&gt;2&lt;/em&gt;
VCS logs for 2010-02-18:
--------------------------------&lt;( PROJECT_1 )&gt;--------------------------------
Added breathtaking feature X
Refactored Y
--------------------------------&lt;( PROJECT_2 )&gt;--------------------------------
Made some tests pass
&lt;strong&gt;Remark&amp;gt;&lt;/strong&gt; &lt;em&gt;Fixed a lot of awesome stuff&lt;/em&gt;
Last log:
Powered on: (0+09:44) Today 06:01 - 15:45
  Awake: (0+00:09) Today 06:01 - 06:10
  Awake: (0+07:44) Today 08:01 - 15:45

&lt;strong&gt;Hours [7:30]&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
&lt;strong&gt;Do you want to change the defaults for worktime period and/or billing percentage? [N/y]&amp;gt;&lt;/strong&gt;  &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
      date: &quot;2010-02-18&quot;
   project: &quot;p2: AnnoyingCustomer - Consulting&quot;
     phase: &quot;Boring phase&quot;
    remark: &quot;Fixed a lot of awesome stuff&quot;
     hours: &quot;7.5&quot;
  worktime: &quot;Normal&quot;
   billing: &quot;Normal (100%)&quot;
&lt;strong&gt;Submit? [Y/n]&amp;gt;&lt;/strong&gt; &lt;em&gt;y&lt;/em&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Notice that to you get some extra help with registering remark and
hours. Achoo fetches the log for your commits for the given day and
shows you when your laptop has been awake (not suspended).

&lt;h3&gt;Flexi time balance&lt;/h3&gt;

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
 :  ...
 2. Show flexitime balance
 :  ...
[1]&amp;gt; &lt;em&gt;2&lt;/em&gt;
&lt;strong&gt;Date ([today] | ?)&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
Fetching dayview ...
Flexi time balance: &lt;u&gt;2:30&lt;/u&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;Day hour report&lt;/h3&gt;

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
 :  ...
 3. Day hour report
 :  ...
&lt;strong&gt;[1]&amp;gt;&lt;/strong&gt; &lt;em&gt;3&lt;/em&gt;
&lt;strong&gt;Date ([today] | ?)&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
+-------------------------------+------------+--------+-------+--------------+----------+--------------------+
| Project                       | Phase      | Remark | Time  | Billing rate | Currency | Billing percentage |
+-------------------------------+------------+--------+-------+--------------+----------+--------------------+
| p1: NiceCustomer - Consulting | Cool phase | Foo    | 07:30 | 1000.00      | NOK      | Normal (100%)      |
+-------------------------------+------------+--------+-------+--------------+----------+--------------------+
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;Week hour report&lt;/h3&gt;

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
 :  ...
 4. Week hour report
 :  ...
&lt;strong&gt;[1]&amp;gt;&lt;/strong&gt; &lt;em&gt;4&lt;/em&gt;
&lt;strong&gt;Date ([today] | ?)&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
Fetching weekview ...
&lt;span style=&quot;font-size:small&quot;&gt;+--------------------------------------------+-------------+-------------+-------------+-------------+------------+------------+------------+-------+
| Project - Phase                            | Mon (02-15) | Tue (02-16) | Wed (02-17) | Thu (02-18) | Fri(02-19) | Sat(02-20) | Sun(02-21) | Total |
+--------------------------------------------+-------------+-------------+-------------+-------------+------------+------------+------------+-------+
| p1: NiceCustomer - Consulting - Nice phase | 7:30        | 2:00        |             |             |            |            |            | 9:30  |
| abs: Absence - Holiday                     |             | 5:30        | 7:30        | 7:30        |            |            |            | 20:30 |
+--------------------------------------------+-------------+-------------+-------------+-------------+------------+------------+------------+-------+
| Total                                      | 7:30        | 7:30        | 7:30        | 7:30        |            |            |            | 29:30 |
+--------------------------------------------+-------------+-------------+-------------+-------------+------------+------------+------------+-------+&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;Holiday balance&lt;/h3&gt;

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
 :  ...
 5. Holiday balance
 :  ...
&lt;strong&gt;[1]&amp;gt;&lt;/strong&gt; &lt;em&gt;5&lt;/em&gt;
Balance: &lt;u&gt;26,00&lt;/u&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;h3&gt;Lock month&lt;/h3&gt;

&lt;p&gt;Achoo selects the previous month as the default

&lt;div class=&quot;CodeRay&quot;&gt;&lt;pre style=&quot;font-size:medium;&quot;&gt;
 :  ...
 6. Lock month
 :  ...
&lt;strong&gt;[1]&amp;gt;&lt;/strong&gt; &lt;em&gt;6&lt;/em&gt;
&lt;strong&gt;Period ([201001] | YYYYMM)&amp;gt;&lt;/strong&gt; &lt;em&gt;&amp;lt;enter&amp;gt;&lt;/em&gt;
period: 201001
&lt;strong&gt;Submit? [Y/n]&amp;gt;&lt;/strong&gt; &lt;em&gt;n&lt;/em&gt;
Cancelled
&lt;/pre&gt;&lt;/div&gt;</content>
  </entry>
  
  <entry>
    <title>IPv6 addresses and MySQL</title>
    <link href="/bliki/IPv6AdressesAndMysql.html" />
    <id>tag:oierud.name/~kjellm,2009-02-19:1235040590</id>
    <updated>2009-02-19T11:49:50+01:00</updated>
    <content type="html">



&lt;p&gt;I usually prefer storing IP addresses as integers (unless the DBMS
  have a special data type for it). Using integers gives compact
  storage and makes it easy to answer questions like what is the next
  IP address? In which subnets does it belong? Etc. IPv6 addresses is
  128 bits long, so to store that as an integer in MySQL you need to
  use the &lt;code&gt;DECIMAL&lt;/code&gt; data type.

&lt;/p&gt;&lt;p&gt;In MySQL there is two functions that help you translate between the
  familiar canonical version and the numeric version of IP addresses:
  INET_ATON() and INET_NTOA(). However these functions do not work
  with IPv6 addresses.

&lt;/p&gt;&lt;p&gt;One possible solution to this is to implement INET_ATON6() and
INET_NTOA6() yourself as stored functions:

&lt;/p&gt;&lt;h3&gt;INET_ATON6&lt;/h3&gt;

&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;DELIMITER //
&lt;span class=&quot;r&quot;&gt;CREATE&lt;/span&gt; FUNCTION INET_ATON6(n &lt;span class=&quot;pt&quot;&gt;CHAR&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
RETURNS &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;) &lt;span class=&quot;pt&quot;&gt;UNSIGNED&lt;/span&gt;
DETERMINISTIC
&lt;span class=&quot;r&quot;&gt;BEGIN&lt;/span&gt;
    RETURN &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt;  &lt;span class=&quot;i&quot;&gt;1&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       * &lt;span class=&quot;i&quot;&gt;5192296858534827628530496329220096&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 7&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt;  &lt;span class=&quot;i&quot;&gt;6&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       *      &lt;span class=&quot;i&quot;&gt;79228162514264337593543950336&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 6&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;11&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       *          &lt;span class=&quot;i&quot;&gt;1208925819614629174706176&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 5&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;)) 
                       *               &lt;span class=&quot;i&quot;&gt;18446744073709551616&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 4&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;21&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       *                    &lt;span class=&quot;i&quot;&gt;281474976710656&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 3&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;26&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       *                         &lt;span class=&quot;i&quot;&gt;4294967296&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 2&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;31&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
                       *                              &lt;span class=&quot;i&quot;&gt;65536&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;-- 65536 ^ 1&lt;/span&gt;
         + &lt;span class=&quot;pd&quot;&gt;CAST&lt;/span&gt;(CONV(SUBSTRING(n &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;36&lt;/span&gt; FOR &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;))
         ;
&lt;span class=&quot;r&quot;&gt;END&lt;/span&gt;;
//
DELIMITER ;&lt;/code&gt;&lt;/pre&gt;


&lt;h3&gt;INET_NTOA6&lt;/h3&gt;
&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;DELIMITER //
&lt;span class=&quot;r&quot;&gt;CREATE&lt;/span&gt; FUNCTION INET_NTOA6(n &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;) &lt;span class=&quot;pt&quot;&gt;UNSIGNED&lt;/span&gt;)
RETURNS &lt;span class=&quot;pt&quot;&gt;CHAR&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;)
DETERMINISTIC
&lt;span class=&quot;r&quot;&gt;BEGIN&lt;/span&gt;
  DECLARE a &lt;span class=&quot;pt&quot;&gt;CHAR&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;)             &lt;span class=&quot;di&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;;
  DECLARE i &lt;span class=&quot;pt&quot;&gt;INT&lt;/span&gt;                  &lt;span class=&quot;di&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;7&lt;/span&gt;;
  DECLARE q &lt;span class=&quot;pt&quot;&gt;DECIMAL&lt;/span&gt;(&lt;span class=&quot;i&quot;&gt;39&lt;/span&gt;) &lt;span class=&quot;pt&quot;&gt;UNSIGNED&lt;/span&gt; &lt;span class=&quot;di&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;;
  DECLARE r &lt;span class=&quot;pt&quot;&gt;INT&lt;/span&gt;                  &lt;span class=&quot;di&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;;
  WHILE i DO
    &lt;span class=&quot;c&quot;&gt;-- DIV doesn't work with nubers &amp;gt; bigint&lt;/span&gt;
    &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; q &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= FLOOR(n / &lt;span class=&quot;i&quot;&gt;65536&lt;/span&gt;);
    &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; r &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= n MOD &lt;span class=&quot;i&quot;&gt;65536&lt;/span&gt;;
    &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; n &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= q;
    &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; a &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= CONCAT_WS(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;, LPAD(CONV(r, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;), a);

    &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; i &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= i - &lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;;
  &lt;span class=&quot;r&quot;&gt;END&lt;/span&gt; WHILE;

  &lt;span class=&quot;r&quot;&gt;SET&lt;/span&gt; a &lt;span class=&quot;er&quot;&gt;:&lt;/span&gt;= TRIM(TRAILING &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;r&quot;&gt;FROM&lt;/span&gt; CONCAT_WS(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;,
                                            LPAD(CONV(n, &lt;span class=&quot;i&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;), &lt;span class=&quot;i&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;),
                                            a));

  RETURN a;

&lt;span class=&quot;r&quot;&gt;END&lt;/span&gt;;
//
DELIMITER ;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The code is to be regarded as a proof of concept as it needs sanity
  checks and handling of simplified address notations before
  production use. However the following small test verifies that it is
  not completely broken:

&lt;/p&gt;&lt;div class=&quot;CodeRay&quot;&gt;
&lt;pre&gt;
mysql&amp;gt; &lt;strong&gt;SELECT INET_NTOA6(INET_ATON6(&lt;/strong&gt;
    -&amp;gt;   &lt;strong&gt;'2001:0db8:85a3:0000:0000:8a2e:0370:7334'));&lt;/strong&gt;
+-------------------------------------------------------------------+
| INET_NTOA6(INET_ATON6('2001:0db8:85a3:0000:0000:8a2e:0370:7334')) |
+-------------------------------------------------------------------+
| 2001:0DB8:85A3:0000:0000:8A2E:0370:7334                           |
+-------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&amp;gt; &lt;strong&gt;SELECT INET_NTOA6(INET_ATON6(&lt;/strong&gt;
    -&amp;gt;   &lt;strong&gt;'ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff'));&lt;/strong&gt;
+-------------------------------------------------------------------+
| INET_NTOA6(INET_ATON6('ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff')) |
+-------------------------------------------------------------------+
| FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF                           |
+-------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&amp;gt; &lt;strong&gt;select INET_NTOA6(INET_ATON6(&lt;/strong&gt;
    -&amp;gt;   &lt;strong&gt;'0000:0000:0000:0000:0000:0000:0000:0000'));&lt;/strong&gt;
+-------------------------------------------------------------------+
| INET_NTOA6(INET_ATON6('0000:0000:0000:0000:0000:0000:0000:0000')) |
+-------------------------------------------------------------------+
| 0000:0000:0000:0000:0000:0000:0000:0000                           |
+-------------------------------------------------------------------+
1 row in set (0.01 sec)
&lt;/pre&gt;
&lt;/div&gt;</content>
  </entry>
  
  <entry>
    <title>Improved Munin Graphs for MySQL</title>
    <link href="/bliki/ImprovedMuninGraphsForMySQL.html" />
    <id>tag:oierud.name/~kjellm,2009-02-13:1234538085</id>
    <updated>2009-02-13T16:14:45+01:00</updated>
    <content type="html">

&lt;p&gt;
  Inspired by &lt;a href=&quot;http://www.xaprb.com/blog/&quot;&gt;Xaprb's&lt;/a&gt; &lt;a
  href=&quot;http://code.google.com/p/mysql-cacti-templates/&quot;&gt;improved graphs for
  Cacti&lt;/a&gt;, I wrote a plugin that creates similar graphs for &lt;a
  href=&quot;http://munin.projects.linpro.no/&quot;&gt;Munin&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;
  The plugin is included in the Munin project. For the newest version, go to
  &lt;a href=&quot;https://github.com/kjellm/munin-mysql&quot;&gt;my project page on github&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;Some features:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    Data collected from MySQL is stored in shared memory, thus avoiding
    unnecessary server requests.
  &lt;/li&gt;
  &lt;li&gt;
    Easy to create new graphs by adding a graph definition to the plugin.
  &lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;div style='text-align:center'&gt;
  &lt;img alt='screenshot collage' src='/images/munin-mysql.png' /&gt;
  &lt;br /&gt;
  &lt;p&gt;&lt;span class='credit'&gt;(Thanks to Bart van Bragt for the graph images)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</content>
  </entry>
  
  <entry>
    <title>Drawing graphs with Ruby, GTK, Cairo, and Graphviz</title>
    <link href="/bliki/DrawingGraphsWithRubyGTKCairoAndGraphviz.html" />
    <id>tag:oierud.name/~kjellm,2008-10-20:1224528461</id>
    <updated>2008-10-20T20:47:41+02:00</updated>
    <content type="html">



&lt;p&gt;Recently I wrote a prototype where I needed a quick solution for
  automatically laying out and drawing undirected graphs. The
  prototype was written in Ruby using GTK for the GUI.

&lt;/p&gt;&lt;p&gt;I post here a small program which illustrates the basics on how this
  can be done, with a hope that it might be useful to others. To save
  some cut n' paste, you can download the source file from &lt;a href=&quot;https://gist.github.com/1315902&quot;&gt;this gist&lt;/a&gt;.

&lt;/p&gt;&lt;p&gt;Here is a sneak peek on the result.

&lt;/p&gt;&lt;div class=&quot;illustration&quot;&gt;&lt;img src=&quot;/images/drawing_graphs.png&quot; alt=&quot;The result&quot;&gt;&lt;/div&gt;

&lt;p&gt;First we need a simple example graph to work with. Let us define a
  graph as an array of edges. Each edge is an array with two vertices,
  represented by symbols.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;dt&quot;&gt;#!/usr/bin/env ruby -w&lt;/span&gt;

edges = [[&lt;span class=&quot;sy&quot;&gt;:a&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:b&lt;/span&gt;], 
         [&lt;span class=&quot;sy&quot;&gt;:a&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:c&lt;/span&gt;], 
         [&lt;span class=&quot;sy&quot;&gt;:b&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:c&lt;/span&gt;], 
         [&lt;span class=&quot;sy&quot;&gt;:c&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:d&lt;/span&gt;],
         [&lt;span class=&quot;sy&quot;&gt;:d&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:e&lt;/span&gt;],
         [&lt;span class=&quot;sy&quot;&gt;:d&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:f&lt;/span&gt;],
         [&lt;span class=&quot;sy&quot;&gt;:e&lt;/span&gt;, &lt;span class=&quot;sy&quot;&gt;:f&lt;/span&gt;],
        ]&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The next thing is to calculate a layout of the vertices. To do this
  I use the neato command from &lt;a href=&quot;http://graphviz.org&quot;&gt;Graphviz&lt;/a&gt;. Neato is a program for
  drawing undirected graphs. Graphviz expects its input to be in the
  &lt;a href=&quot;http://en.wikipedia.org/wiki/DOT_language&quot;&gt;dot
  language&lt;/a&gt;.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;dot = &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;graph Test {&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
edges.each &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt; |edge|
  dot &amp;lt;&amp;lt; &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;il&quot;&gt;&lt;span class=&quot;idl&quot;&gt;#{&lt;/span&gt;edge[&lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;].to_s&lt;span class=&quot;idl&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt; -- &lt;/span&gt;&lt;span class=&quot;il&quot;&gt;&lt;span class=&quot;idl&quot;&gt;#{&lt;/span&gt;edge[&lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;].to_s&lt;span class=&quot;idl&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;
dot &amp;lt;&amp;lt; &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;co&quot;&gt;EOT&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Interaction with neato is done using a pipe, and giving it the
  argument &lt;code&gt;-Tplain&lt;/code&gt; produces a graph to stdout with layout
  information. The output format is described &lt;a href=&quot;http://www.graphviz.org/content/output-formats#dplain&quot;&gt;here&lt;/a&gt;.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;layout = &lt;span class=&quot;co&quot;&gt;IO&lt;/span&gt;.popen(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;neato -Tplain&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;r+&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt; |pipe|
  pipe.write(dot)
  pipe.close_write
  pipe.read
&lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Before we proceed, we need to define some variables. Their use
  should be fairly obvious later on.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;vertex_coordinates = {}
padding            = &lt;span class=&quot;i&quot;&gt;20&lt;/span&gt;
scale              = &lt;span class=&quot;i&quot;&gt;100&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we can parse the layout information.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;layout.each &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt; |line|
  &lt;span class=&quot;r&quot;&gt;if&lt;/span&gt; line =~ &lt;span class=&quot;rx&quot;&gt;&lt;span class=&quot;dl&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;^node (&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\w&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;+)  ([&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\d&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;.]+) ([&lt;/span&gt;&lt;span class=&quot;ch&quot;&gt;\d&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;.]+)&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;/&lt;/span&gt;&lt;/span&gt;
    vertex_coordinates[&lt;span class=&quot;gv&quot;&gt;$1&lt;/span&gt;.to_sym] = [&lt;span class=&quot;gv&quot;&gt;$2&lt;/span&gt;.to_f * scale + padding, 
                                     &lt;span class=&quot;gv&quot;&gt;$3&lt;/span&gt;.to_f * scale + padding]
  &lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we create a window to put the drawing inside, using the &lt;a href=&quot;http://ruby-gnome2.sourceforge.jp/&quot;&gt;gtk2&lt;/a&gt; library.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;require &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;gtk2&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;

window = &lt;span class=&quot;co&quot;&gt;Gtk&lt;/span&gt;::&lt;span class=&quot;co&quot;&gt;Window&lt;/span&gt;.new(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;Graph&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;)
window.set_default_size(&lt;span class=&quot;i&quot;&gt;400&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;400&lt;/span&gt;)

window.signal_connect(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;destroy&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;co&quot;&gt;Gtk&lt;/span&gt;.main_quit
&lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And here is the code which draws the graph. The code uses the &lt;a href=&quot;http://www.cairographics.org/&quot;&gt;Cairo&lt;/a&gt; vector drawing
  library in a GTK::DrawingArea.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;area = &lt;span class=&quot;co&quot;&gt;Gtk&lt;/span&gt;::&lt;span class=&quot;co&quot;&gt;DrawingArea&lt;/span&gt;.new
area.signal_connect(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;expose_event&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;) &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt;
  context = area.window.create_cairo_context

  &lt;span class=&quot;c&quot;&gt;# Draw the edges as straight lines between the centers of the&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# vertices.&lt;/span&gt;
  edges.each &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt; |edge|
    context.move_to(*vertex_coordinates[edge[&lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;]])
    context.line_to(*vertex_coordinates[edge[&lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;]])
    context.stroke
  &lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;

  vertex_coordinates.each &lt;span class=&quot;r&quot;&gt;do&lt;/span&gt; |v, c|
    &lt;span class=&quot;c&quot;&gt;# Draw the vertex as a circle filled with white (this hides&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# the edges underneath)&lt;/span&gt;
    context.arc(c[&lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;], c[&lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;i&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;fl&quot;&gt;2.0&lt;/span&gt; * &lt;span class=&quot;co&quot;&gt;Math&lt;/span&gt;::&lt;span class=&quot;co&quot;&gt;PI&lt;/span&gt;)
    context.set_source_rgb(&lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;)
    context.fill_preserve()
    context.set_source_rgb(&lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;)
    context.stroke

    &lt;span class=&quot;c&quot;&gt;# Draw the vertex labels&lt;/span&gt;
    context.set_font_size(&lt;span class=&quot;i&quot;&gt;16&lt;/span&gt;)
    context.select_font_face(&lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;Arial&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;s&quot;&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;bold&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;/span&gt;);
    context.move_to(c[&lt;span class=&quot;i&quot;&gt;0&lt;/span&gt;] - &lt;span class=&quot;i&quot;&gt;6&lt;/span&gt;, c[&lt;span class=&quot;i&quot;&gt;1&lt;/span&gt;] + &lt;span class=&quot;i&quot;&gt;5&lt;/span&gt;)
    context.show_text(v.to_s.upcase)
    context.stroke
  &lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;r&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Finally we add the drawing to the window and start the application.

&lt;/p&gt;&lt;pre class=&quot;CodeRay&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;window.add(area)
window.show_all

&lt;span class=&quot;co&quot;&gt;Gtk&lt;/span&gt;.main&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;THE END&lt;/p&gt;</content>
  </entry>
  
  <entry>
    <title>Missing values in SQL</title>
    <link href="/bliki/MissingValuesInSQL.html" />
    <id>tag:oierud.name/~kjellm,2008-09-18:1221762144</id>
    <updated>2008-09-18T20:22:24+02:00</updated>
    <content type="html">

&lt;div class='notice'&gt;
  &lt;p&gt;
    This article is part of a series on &lt;a
    href=&quot;SelectedTopicsOnDatabaseManagementSystems.html&quot;&gt;selected topics on
    database management systems&lt;/a&gt;
  &lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;
  In SQL we use NULL as a placeholder for missing values. It has at least
  three different uses.
&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    To mark a value in a column as 'missing'.
  &lt;/li&gt;
  &lt;li&gt;
    As placeholders in the result of an &lt;a
    href=&quot;http://en.wikipedia.org/wiki/Join_(SQL)#Outer_joins&quot;&gt;outer join&lt;/a&gt;
    where 'no match' are found between rows.
  &lt;/li&gt;
  &lt;li&gt;
    As the result of arithmetic operations with one or more operands that are
    NULL. Here a NULL means 'unknown', unknown because information that is
    needed for evaluating the expression is missing.
  &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;
  If a value in a column is NULL, all you know is that it is missing. If you
  need to know why, you can store that information in a separate column.
  Another approach is to disallow NULLs and use an encoding that has distinct
  values for missing data. An example is the standard encoding for gender: &lt;a
  href=&quot;http://en.wikipedia.org/wiki/ISO_5218&quot;&gt;ISO 5218&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;
  The usage of NULL is one of the big controversies in SQL and relational
  systems. Some feels that it introduces unnecessary complexity, and the
  general advice seems to be to use NULLs only when there is no better option.
&lt;/p&gt;
&lt;h3&gt;Reasons to avoid NULL&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    NULL behaves differently from similar non-value markers in most
    programming languages.
  &lt;/li&gt;
  &lt;li&gt;
    Some confuses NULL with the empty string, zero, or false.
  &lt;/li&gt;
  &lt;li&gt;
    NULLs introduces 3-valued logic. That is, in addition to TRUE and FALSE
    you also have UNKNOWN, a source of many misunderstandings and errors in
    SQL statements.
  &lt;/li&gt;
  &lt;li&gt;
    Many functions treat NULL in a special manner. To remember how NULL is
    handled by different functions is painful. Some examples: GROUP BY puts
    all rows with NULLs in the same group, thous treating them equal when in
    fact the equality is unknown. The SUM aggregate function ignores NULLs
    when summarizing the values of a column.
  &lt;/li&gt;
  &lt;li&gt;
    Having columns that might be NULL in a table, typically introduces a
    penalty on performance.
  &lt;/li&gt;
  &lt;li&gt;
    Mistakes are Easily made when dealing with ALL, ANY, IN, and EXISTS
    queries.
  &lt;/li&gt;
  &lt;li&gt;
    Having many nullable columns in a table might indicate that the table is
    not properly &lt;a
    href=&quot;http://en.wikipedia.org/wiki/Database_normalization&quot;&gt;normalized&lt;/a&gt;.
  &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Reasons to use NULL&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    It is a good idea to allow NULL when you need to mark a value as missing
    and there is no easy way handle missing values in any reasonable encoding
    for the column. Just be aware that you don't fall in any of the traps
    mentioned above.
  &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Read more&lt;/h3&gt;
&lt;ul class='bibliography'&gt;
  &lt;li&gt;
    Celcko, J. (2005), &lt;em&gt;SQL For Smarties&lt;/em&gt;, San Francisco: Morgan Kaufman&lt;br&gt;Chapter 6
  &lt;/li&gt;
  &lt;li&gt;
    Celcko, J. (2005), &lt;em&gt;SQL Programming Style&lt;/em&gt;, San Francisco: Morgan Kaufman&lt;br&gt;Chapter 5.3.3
  &lt;/li&gt;
  &lt;li&gt;
    Garcia-Molina, H., Ullman, J., &amp;amp; Widom, J. (2002), &lt;em&gt;Database systems: The complete book&lt;/em&gt;, New Jersey: Prentice Hall&lt;br&gt;Chapter 6.1.5
  &lt;/li&gt;
  &lt;li&gt;
    &lt;em&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Null_%28SQL%29&quot;&gt;Null (SQL)&lt;/a&gt;&lt;/em&gt;, Wikipedia
  &lt;/li&gt;
  &lt;li&gt;
    &lt;em&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Null_%28SQL%29#Controversy&quot;&gt;Null (SQL) :: Controversy&lt;/a&gt;&lt;/em&gt;, Wikipedia
  &lt;/li&gt;
  &lt;li&gt;
    de Haan, L., Gennick, J. (2005), &lt;em&gt;&lt;a href=&quot;http://www.oracle.com/technology/oramag/oracle/05-jul/o45sql.html&quot;&gt;Nulls: Nothing to Worry About&lt;/a&gt;&lt;/em&gt;, Oracle Magazinea
  &lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  
  <entry>
    <title>Natural vs surrogate primary keys</title>
    <link href="/bliki/NaturalVsSurrogatePrimaryKeys.html" />
    <id>tag:oierud.name/~kjellm,2008-09-10:1221070962</id>
    <updated>2008-09-10T20:22:42+02:00</updated>
    <content type="html">

&lt;div class='notice'&gt;
  &lt;p&gt;
    This article is part of a series on &lt;a
    href=&quot;SelectedTopicsOnDatabaseManagementSystems.html&quot;&gt;selected topics on
    database management systems&lt;/a&gt;
  &lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;
  To identify the different records in a relational table, we use a primary
  key. There are two kinds of primary keys with very different
  characteristics. A &lt;a
  href=&quot;http://en.wikipedia.org/wiki/Natural_key&quot;&gt;&lt;em&gt;natural key&lt;/em&gt;&lt;/a&gt;
  uses a column or columns that are a natural part of a record, while a &lt;a
  href=&quot;http://en.wikipedia.org/wiki/Surrogate_key&quot;&gt;&lt;em&gt;surrogate key&lt;/em&gt;&lt;/a&gt;
  is added to the record and uses artificial data. When choosing your
  strategy, it is important to be aware of the advantages and disadvantages.
&lt;/p&gt;
&lt;p&gt;
  The main advantage of a natural key is that it can be verified by comparing
  it with real world data. This is how users of the system typically will
  identify data.
&lt;/p&gt;
&lt;p&gt;
  A surrogate key on the other hand has the advantage of being more robust to
  changes in how we identify the records in the real world. When the natural
  key changes (e.g. because of changes in business requirements), you don't
  have to change all your internal references to the record.
&lt;/p&gt;
&lt;p&gt;
  It is also more efficient for the database system to use surrogate keys.
  This is true especially when joining on the primary keys, or if the system
  uses clustered primary key indexes.
&lt;/p&gt;
&lt;p&gt;
  Since a surrogate key normally is internal to a system, it can't be used to
  reference entities in external systems.
&lt;/p&gt;
&lt;p&gt;
  There should always be maintained a natural key in a table even if a
  surrogate key is chosen as the primary. If not, the records will loose their
  connection to the real world. But be aware that the two keys might get out
  of sync without you noticing it.
&lt;/p&gt;
&lt;h3&gt;Read more&lt;/h3&gt;
&lt;ul class='bibliography'&gt;
  &lt;li&gt;
    Celko, J. (2005), &lt;em&gt;SQL Programming Style&lt;/em&gt;, San Francisco: Morgan
    Kaufmann&lt;br&gt;Chapter 3.13
  &lt;/li&gt;
  &lt;li&gt;
    Ambler S. W., &lt;em&gt;&lt;a href=&quot;http://www.agiledata.org/essays/keys.html&quot;&gt;
    Choosing a Primary Key: Natural or Surrogate?&lt;/a&gt;&lt;/em&gt;, Agile Data
  &lt;/li&gt;
  &lt;li&gt;
    Richardson L. (2007), &lt;em&gt;&lt;a
    href=&quot;http://rapidapplicationdevelopment.blogspot.com/2007/08/in-case-youre-new-to-series-ive.html&quot;&gt;Surrogate
    vs Natural Primary Keys – Data Modeling Mistake 2 of 10&lt;/a&gt;&lt;/em&gt;, Rapid
    Application Development Blog
  &lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  
</feed>